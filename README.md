# elgongRPC 框架实践
尝试动手实现一个rpc



[TOC]

## elgongRPC 结构

![框架](https://github.com/elgong/elgongRPC/blob/master/rpc.png)



## elgongRPC  V1.0 特点

- **分层设计**: 尽可能的分层设计，每个层避免出现循环依赖，但可能出现单向的依赖；

  - **特殊情况**：比如 `protocol 层`依赖于` codec层`，但是最终调用使用的是`protocol层`对外提供接口， 用户感知不到。 

- **组件尽可能插件化**：由统一的插件管理中心来管理注册和使用

  - **实现思路**：同种类型插件实现同一个类型接口，把自己注册到管理中心的map， 调用时使用接口来统一断言调用；
  - **支持多种编解码方式**，可以通过实现 `codec`接口来增加自定义的编解码
  - 插件均支持自定义拓展

- **连接池**： 连接池管理连接，减少服务器建立连接断开连接的开销；

  - **实现思路**：为每个IP 建立一个池子，每个池子的底层利用链表管理起来；

  - **目前涵盖功能**：（通过参数配置，还未实现参数解析）

    - 1. 惰性初始化
      2. 连接数量控制
      3. 连接健康管理（定时处理掉失效连接）（服务端通过read 返回EOF来判断对方是否掉线； 客户端通过心跳包）
      4. 支持最大连接数，闲置连接数，最大连接时长控制。

    

##  elgongRPC V2.0 将会增加的功能

- 调用链设计（参考grpc）

  服务注册与服务发现插件

- 负载均衡插件（两次随机负载均衡+轮询 + 带权）

- log 插件

**还未压测，待V2.0 再压测，现在功能还不完善**

## elgongRPC V1.0 使用DEMO

待补充。。



## commit 约定

- 添加新文件：
  - --new=文件功能
- 修改文件内容：
  - --edited=修改内容
- 其他：
  - --other=其他
- bug
  - --bugfix=bug内容
